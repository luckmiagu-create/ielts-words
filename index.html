<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<meta name="theme-color" content="#16a34a">

<style>
:root{
  --bg:#f0fdf4;
  --card:#ffffff;
  --text:#064e3b;
  --sub:#4b5563;
  --main:#16a34a;
  --danger:#dc2626;
}
*{box-sizing:border-box}
body{
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,"PingFang SC","Microsoft YaHei",Arial;
  background:var(--bg);
  color:var(--text);
}
.app{max-width:420px;margin:auto;padding:14px 14px 80px}
.header{
  display:flex;align-items:center;gap:10px;
  font-size:18px;font-weight:600;
  margin-bottom:12px;
}
.logo{
  width:36px;height:36px;border-radius:10px;
  background:linear-gradient(135deg,#22c55e,#16a34a);
  color:#fff;display:flex;align-items:center;justify-content:center;
  font-weight:700;
}
.card{
  background:var(--card);
  border-radius:18px;
  padding:18px;
  box-shadow:0 10px 25px rgba(0,0,0,.1);
}
.question{
  font-size:24px;font-weight:700;text-align:center;
}
.hint{
  text-align:center;color:var(--sub);margin-top:6px;
}
input,textarea{
  width:100%;
  padding:14px;
  font-size:18px;
  border-radius:14px;
  border:2px solid #d1fae5;
  margin-top:12px;
  outline:none;
}
input:focus{border-color:var(--main)}
.result{
  text-align:center;
  font-size:18px;
  margin-top:10px;
  font-weight:600;
}
.correct{color:#16a34a}
.wrong{color:#dc2626}
.answer{text-align:center;margin-top:6px;color:#374151}
.row{
  display:flex;gap:10px;justify-content:center;
  margin-top:12px;flex-wrap:wrap;
}
button{
  padding:10px 14px;
  border:none;border-radius:14px;
  font-size:15px;
  background:var(--main);
  color:#fff;
  cursor:pointer;
}
.secondary{background:#6b7280}
.stats{
  text-align:center;
  margin-top:12px;
  font-size:13px;
  color:var(--sub);
}

/* 悬浮添加按钮 */
.fab{
  position:fixed;
  right:18px;
  bottom:18px;
  width:56px;
  height:56px;
  border-radius:50%;
  background:var(--main);
  color:#fff;
  font-size:28px;
  display:flex;
  align-items:center;
  justify-content:center;
  box-shadow:0 12px 25px rgba(0,0,0,.25);
  cursor:pointer;
  z-index:999;
}

/* 添加面板 */
#addPanel{
  position:fixed;
  left:0;right:0;bottom:0;
  background:#fff;
  border-radius:20px 20px 0 0;
  padding:18px;
  box-shadow:0 -10px 25px rgba(0,0,0,.2);
  display:none;
}
</style>
</head>

<body>
<div class="app">

<div class="header">
  <div class="logo">IELTS</div>
  单词记忆
</div>

<div class="row">
  <button onclick="setMode('en2cn')">英 → 汉</button>
  <button onclick="setMode('cn2en')" class="secondary">汉 → 英</button>
  <button onclick="setPool('wrong')" class="secondary">错题本</button>
</div>

<div class="card">
  <div class="question" id="q">请添加单词</div>
  <div class="hint" id="hint"></div>
  <input id="input" placeholder="输入答案，回车确认" enterkeyhint="done">
  <div class="result" id="result"></div>
  <div class="answer" id="answer"></div>
</div>

<div class="row">
  <button onclick="prev()">上一个</button>
  <button onclick="next()">下一个</button>
  <button onclick="showAnswer()" class="secondary">答案</button>
</div>

<div class="stats" id="stats"></div>

</div>

<!-- 悬浮添加按钮 -->
<div class="fab" onclick="toggleAdd()">＋</div>

<!-- 添加单词面板 -->
<div id="addPanel">
  <div class="row">
    <button onclick="setAddMode('single')">单个</button>
    <button onclick="setAddMode('batch')" class="secondary">批量</button>
    <button onclick="toggleAdd()" class="secondary">关闭</button>
  </div>

  <div id="singleAdd">
    <input id="newEn" placeholder="英文">
    <input id="newCn" placeholder="中文">
    <button onclick="addSingle()">保存</button>
  </div>

  <div id="batchAdd" style="display:none">
    <textarea id="batchText" placeholder="abandon=放弃"></textarea>
    <button onclick="addBatch()">批量导入</button>
  </div>
</div>

<script>
let mode="en2cn", pool="all", addMode="single";
let words=JSON.parse(localStorage.getItem("words"))||[];
let index=0;
let current=null;

function save(){localStorage.setItem("words",JSON.stringify(words))}

function setMode(m){mode=m;pool="all";index=0;render()}
function setPool(p){pool=p;index=0;render()}

function getList(){
  if(pool==="wrong") return words.filter(w=>w.wrong);
  return words;
}

function render(){
  const list=getList();
  if(!list.length){
    q.textContent="暂无单词";
    hint.textContent="";
    return;
  }
  current=list[index%list.length];
  q.textContent=mode==="en2cn"?current.en:current.cn;
  hint.textContent=mode==="en2cn"?"请输入中文":"请输入英文";
  input.value="";
  result.textContent="";
  answer.textContent="";
  stats.textContent=`词库 ${words.length} ｜ 错题 ${words.filter(w=>w.wrong).length}`;
}

function check(){
  if(!current) return;
  const v=input.value.trim();
  let ok=false;
  if(mode==="en2cn") ok=current.cn.includes(v);
  else ok=v.toLowerCase()===current.en;

  if(ok){
    result.textContent="✅ 正确";
    result.className="result correct";
    current.wrong=0;
    save();
    setTimeout(next,500);
  }else{
    result.textContent="❌ 错误";
    result.className="result wrong";
    current.wrong=1;
    answer.textContent="正确答案："+(mode==="en2cn"?current.cn:current.en);
    save();
  }
}

input.addEventListener("keydown",e=>{
  if(e.key==="Enter"){e.preventDefault();check();}
});

function next(){index++;render()}
function prev(){index=Math.max(0,index-1);render()}
function showAnswer(){
  if(current) answer.textContent="正确答案："+(mode==="en2cn"?current.cn:current.en);
}

function toggleAdd(){
  addPanel.style.display=addPanel.style.display==="block"?"none":"block";
}
function setAddMode(m){
  addMode=m;
  singleAdd.style.display=m==="single"?"block":"none";
  batchAdd.style.display=m==="batch"?"block":"none";
}
function addSingle(){
  const en=newEn.value.trim().toLowerCase();
  const cn=newCn.value.trim();
  if(!en||!cn)return;
  if(words.find(w=>w.en===en))return;
  words.push({en,cn,wrong:0});
  save();toggleAdd();render();
}
function addBatch(){
  batchText.value.split(/\r?\n/).forEach(l=>{
    if(l.includes("=")){
      const [en,cn]=l.split("=");
      if(en&&cn&&!words.find(w=>w.en===en.trim().toLowerCase())){
        words.push({en:en.trim().toLowerCase(),cn:cn.trim(),wrong:0});
      }
    }
  });
  save();toggleAdd();render();
}

render();
</script>
</body>
</html>
